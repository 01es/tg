<link rel="import" href="/resources/polymer/polymer/polymer.html">

<link rel="import" href="/resources/editors/tg-editor-behavior.html">
<link rel="import" href="/resources/editors/tg-editor.html">

<link rel="import" href="/resources/polymer/iron-input/iron-input.html">

<dom-module id="tg-decimal-editor">
    <style>
        /* Styles for integer and decimal property editors. */
        input[type=number]::-webkit-outer-spin-button,
        input[type=number]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
    <template>
        <tg-editor 
    		id="editorDom" 
    		prop-title="[[propTitle]]"
    		_disabled="[[_disabled]]" 
    		_editing-value="{{_editingValue}}" 
    		action="[[action]]" 
    		_error="[[_error]]" 
    		_comm-value="[[_commValue]]" 
    		_accepted-value="[[_acceptedValue]]" 
    		debug="[[debug]]">
    		<input
    			id="input"
    			class="custom-input decimal-input"
    			is="iron-input"
    			type="number"
    			step="any"
    			prevent-invalid-input
    			bind-value="{{_editingValue}}"
    			on-change="_onChange"
    			on-input="_onInput"
    			on-keydown="_onKeydown"
    			disabled$="[[_disabled}}"/>
    		<content class=".property-action"></content>
    	</tg-editor>
    </template>
</dom-module>
<script>
    (function(){
        Polymer({
            is: 'tg-decimal-editor',
            behaviors: [ Polymer.TgBehaviors.TgEditorBehavior ],
            
            /**
             * Converts the value into string representation (which is used in editing / comm values).
             */
            convertToString: function (value) {
                return value === null ? "" : "" + value;
            },
            
            /**
             * Converts the value from string representation (which is used in editing / comm values) into concrete type of this editor component (Number).
             */
            convertFromString: function (strValue) {
                if (strValue === '') {
                    return null;
                }
                // var convertedNumber = (+strValue);
                if (isNaN(strValue)) {
                    throw "The entered number is incorrect.";
                }
                return (+strValue);
            }
        });
    })()
</script>