<link rel="import" href="/resources/polymer/polymer/polymer.html">

<link rel="import" href="/resources/editors/tg-editor.html">
<link rel="import" href="/resources/polymer/paper-input/paper-input-decorator.html">
<link rel="import" href="/resources/polymer/core-input/core-input.html">
<link rel="import" href="/resources/master/actions/tg-property-action.html">
<link rel="import" href="/resources/polymer/core-tooltip/core-tooltip.html">

<polymer-element name="tg-decimal-editor" extends="tg-editor">
    <template>
        <style>
            input[type=number]::-webkit-outer-spin-button,
            input[type=number]::-webkit-inner-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }
            
            input[type=number] {
                -moz-appearance: textfield;
            }
        </style>
        <paper-input-decorator id="decorator" label="{{propTitle}}" floatingLabel value="{{editingValue}}" disabled?="{{_isDisabled(currentState)}}">
            <div layout horizontal>
                <div id="input-container" flex>
                    <core-tooltip position="bottom" class="delayed" style="width:100%" disabled="{{!tooltip(propDesc)}}">
                        <input id="input" is="core-input" type="number" step="any" preventInvalidInput value="{{editingValue}}" committedValue="{{commValue}}" disabled?="{{_isDisabled(currentState)}}">
                        <span class="span-tooltip" tip>
                            {{tooltip(propDesc)}}
                        </span>
                    </core-tooltip>
                </div>
                <div id="icon" hidden?="{{!action}}">
                    <tg-property-action user="{{action.user}}" entitytype="{{action.entitytype}}" preAction="{{action.preAction}}" postActionSuccess="{{action.postActionSuccess}}" postActionError="{{action.postActionError}}" enabledStates="{{action.enabledStates}}" longDesc="{{action.longDesc}}" shortDesc="{{action.shortDesc}}" icon="{{action.icon}}" currentState="{{currentState}}"></tg-property-action>
                </div>
            </div>
        </paper-input-decorator>
        <shadow></shadow>
        <!-- p>$.input.committedValue: {{$.input.committedValue}}</p -->
    </template>
    <script>
        Polymer('tg-decimal-editor', {
            /**
             * Converts the value into string representation (which is used in editing / comm values).
             */
            convertToString: function (value) {
                return value === null ? "" : "" + value;
            },

            /**
             * Converts the value from string representation (which is used in editing / comm values) into concrete type of this editor component (Number).
             */
            convertFromString: function (strValue) {
                if (strValue === '') {
                    return null;
                }
                // var convertedNumber = (+strValue);
                if (isNaN(strValue)) {
                    throw "The entered number is incorrect.";
                }
                return (+strValue);
            }
        });
    </script>
</polymer-element>