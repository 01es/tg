<link rel="import" href="/resources/polymer/polymer/polymer.html">

<link rel="import" href="/resources/editors/tg-editor.html">
<link rel="import" href="/resources/polymer/paper-input/paper-input-decorator.html">
<link rel="import" href="/resources/polymer/core-input/core-input.html">
<link rel="import" href="/resources/master/actions/tg-property-action.html">
<link rel="import" href="/resources/polymer/paper-checkbox/paper-checkbox.html">

<polymer-element name="tg-boolean-editor" extends="tg-editor">
    <template>
        <paper-input-decorator id="decorator" label="{{propTitle}}" floatingLabel value="{{editingValue}}" isInvalid="{{_msgType(entity, propertyName, editorValidationMsg) === 'ERROR'}}" error="{{_msgType(entity, propertyName, editorValidationMsg) === 'ERROR' ? _msg(entity, propertyName, editorValidationMsg) : ''}}" disabled?="{{_isDisabled(currentState)}}">
            <div layout horizontal>
                <div id="input-container" flex>
                    <paper-checkbox id="input" checked?="{{editingValue === 'true'}}" label="{{propTitle}}" disabled?="{{_isDisabled(currentState)}}" on-core-change="{{onCoreChange}}">
                </div>
                <div id="icon" hidden?="{{!action}}">
                    <tg-property-action user="{{action.user}}" entitytype="{{action.entitytype}}" preAction="{{action.preAction}}" postActionSuccess="{{action.postActionSuccess}}" postActionError="{{action.postActionError}}" enabledStates="{{action.enabledStates}}" longDesc="{{action.longDesc}}" icon="{{action.icon}}" currentState="{{currentState}}"></tg-property-action>
                </div>
            </div>
        </paper-input-decorator>
        <shadow></shadow>
    </template>
    <script>
        Polymer('tg-boolean-editor', {
            /**
             * Converts the value into string representation (which is used in edititing / comm values).
             */
            convertToString: function(value) {
                return "" + value;
            },

            // editingValue === 'true'


            /**
             * Converts the value from string representation (which is used in edititing / comm values) into concrete type of this editor component (String).
             */
            convertFromString: function(strValue) {
            	if (strValue !== "false" && strValue !== "true") {
            		throw "The entered check value is incorrect [" + strValue + "].";
            	}            	
                return strValue === "true" ? true : false;
            },

            onCoreChange: function() {
            	this.editingValue = this.convertToString(this.$.input.checked);
            	this.commit();
            }
        });
    </script>
</polymer-element>