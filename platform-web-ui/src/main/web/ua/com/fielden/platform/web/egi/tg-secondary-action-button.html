<link rel="import" href="/resources/polymer/polymer/polymer.html">
<link rel="import" href="/resources/polymer/paper-dropdown/paper-dropdown.html">
<link rel="import" href="/resources/polymer/core-icon-button/core-icon-button.html">
<link rel="import" href="/resources/actions/tg-ui-action.html">

<polymer-element name="tg-secondary-action-button" attributes="actions currentEntity">
    <template>
        <style>
            * /deep/ core-tooltip::shadow #tooltip {
                white-space: normal;
            }
            * /deep/ core-tooltip .span-tooltip {
                line-height: 15px;
            }
            core-tooltip.delayed:hover::shadow .core-tooltip,
            core-tooltip.delayed:focus::shadow .core-tooltip {
                opacity: 1;
                -webkit-transition-delay: 1s;
                transition-delay: 1s;
                transform: translate3d(0px, 0px, 0px);
            }
        </style>
        <core-icon-button icon="more-vert" on-tap="{{showDropDown}}"></core-icon-button>
        <paper-dropdown id="dropdown" style="position:absolute" on-tap="{{closeDropDown}}">
        	<div layout vertical>
            	<template repeat="{{action in actions}}">
            		<tg-ui-action currentEntity="{{currentEntity}}" user="{{action.user}}" shortDesc="{{action.shortDesc}}" longDesc="{{action.longDesc}}" icon="{{action.icon}}" componentUri="{{action.componentUri}}" elementName="{{action.elementName}}" attrs="{{action.attrs}}" createContextHolder="{{action.createContextHolder}}" requireSelectedEntities="{{action.requireSelectedEntities}}" requireMasterEntity="{{action.requireMasterEntity}}" preAction="{{action.preAction}}" postActionSuccess="{{action.postActionSuccess}}" postActionError="{{action.postActionError}}"></tg-ui-action>
            	</template>
            </div>
        </paper-dropdown>
    </template>
    <script>
        (function () {
            Polymer({
            	publish: {
            		/**
                     * The 'currentEntity' should contain the entity that was clicked (result-set actions)
    	             * or the entity on which primary / secondary action was chosen. In case when no of the above cases
        	         * is invoking (for e.g. as in topLevel actions) -- 'currentEntity' should be empty.
    				 */
                    currentEntity: null            		
            	},
            	
                showDropDown: function() {
                    this.$.dropdown.toggle();
                },
                closeDropDown: function() {
                    this.$.dropdown.toggle();
                }
            });
        })();
    </script>
</polymer-element>