<link rel="import" href="/resources/polymer/polymer/polymer.html">
<link rel="import" href="/resources/polymer/iron-list/iron-list.html">
<link rel="import" href="/resources/polymer/iron-scroll-threshold/iron-scroll-threshold.html">

<dom-module id="tg-year-selector">
    <style>
    </style>
    <template>
        <iron-scroll-threshold on-lower-threshold="_loadFutureYears" on-upper-threshold="_loadPastYears" lower-threshold="50" upper-threshold="50" id="threshold">
            <iron-list scroll-target="threshold" items="[[years]]" selected-item="{{selectedYear}}">
                <template>
                    <div class="year-item layout horizontal center-center" selected$="[[selected]]">[[item]]</div>
                </template>
            </iron-list>
        </iron-scroll-threshold>
    </template>
</dom-module>
<script>
    (function () {
        Polymer({

            is: "tg-year-selector",

            properties: {
                selectedYear: {
                    type: Number,
                    notify: true,
                },
                yearIncrement: Number,
                years: Array,
                
                _lastFutureYear: Number,
                _lastPastYear: Number,
            },

            ready: function () {
                var today = new Date();
                this.selectedYear = today.getFullYear();
                this.yearIncrement = 10;
                this.years = [];
            },
            
            attached: function () {
                this._lastPastYear = this._loadPastYears();
                this._lastFutureYear = this._loadFutureYears();
                this.years.push(this.selectedYear);
            },
            
            _loadPastYears: function () {
                var year = this._lastPastYear || this.selectedYear;
                var yearCounter;
                for (yearCounter = 1; yearCounter < this.yearIncrement; yearCounter++) {
                    year-=1;
                    this.years.unshift(year);
                }
                this._lastPastYear = year;
            },
            
            _loadFutureYears: function () {
                var year = this._lastFutureYear || this.selectedYear;
                var yearCounter;
                for (yearCounter = 1; yearCounter < this.yearIncrement; yearCounter++) {
                    year+=1;
                    this.years.push(year);
                }
                this._lastFutureYear = year;
            },
        });
    })();
</script>