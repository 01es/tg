<!--
    @license
    Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
    This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
    The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
    The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
    Code distributed by Google as part of the polymer project is also
    subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<!doctype html>
<html>

<head>

    <script src="/resources/polymer/webcomponentsjs/webcomponents.js"></script>

    <link href="/resources/polymer/core-icons/core-icons.html" rel="import">
    <link href="/resources/polymer/core-icon-button/core-icon-button.html" rel="import">
    <link href="/resources/polymer/core-toolbar/core-toolbar.html" rel="import">
    <link href="/resources/polymer/core-animated-pages/core-animated-pages.html" rel="import">
    <link href="/resources/layout/tg-tile-layout.html" rel="import">
    <link rel="import" href="/resources/polymer/core-icons/av-icons.html">

    <style>
        body {
            font-family: sans-serif;
        }
        .toolbar {
            background-color: steelblue;
        }
        #container {
            overflow: hidden;
        }
        #noscroll {
            overflow-x: hidden;
            overflow-y: auto;
        }
        .item-name {
            height: 48px;
            min-height: 48px;
            padding: 0 16px;
            font-size: 12px;
        }
        .item-icon-bg {
            width: 80%;
            height: 80%;
        }
        .item-icon-bg core-icon {
            width: 100%;
            height: 100%;
        }
        core-icon>div {
            background-repeat: no-repeat;
        }
        .item {
            margin: 4px;
        }
    </style>

</head>

<body unresolved fullbleed vertical layout>
    <template is="auto-binding">
        <core-toolbar class="toolbar">
            <core-icon-button icon="{{$.pages.selected != 0 ? 'arrow-back' : 'menu'}}" on-tap="{{back}}"></core-icon-button>
            <div flex>Stuff</div>
            <core-icon-button icon="more-vert"></core-icon-button>
        </core-toolbar>
        <core-animated-pages id="pages" flex selected="{{selected}}" on-core-animated-pages-transition-end="{{transitionend}}" transitions="hero-transition">

            <section vertical layout name="menu">

                <div id="noscroll" fit>
                    <div id="container" flex horizontal wrap around-justified layout>
                        <tg-tile-layout whenDesktop="{{whenDesktop}}" whenTablet="{{whenTablet}}" whenMobile="{{whenMobile}}" minCellWidth="100px" minCellHeight="100px">
                            <template repeat="{{item in items}}">
                                <div class="tile" vertical layout>
                                    <div class="item" style="background-color: {{item.theme}}" fit layout vertical center-center hero-id="{{'hero_' + item.name}}" hero?="{{$.pages.selected === item.name}}" on-tap="{{selectView}}">
                                        <span>{{item.name}}</span>
                                    </div>
                                </div>
                            </template>
                        </tg-tile-layout>
                    </div>
                </div>

            </section>

            <template repeat="{{item in items}}">
                <section fit name="{{item.name}}">
                    <div class="view" style="background-color: {{item.theme}}" fit layout vertical center-center hero-id="{{'hero_' + item.name}}" hero?="{{$.pages.selected === item.name}}">
                        <span>{{item.name}}</span>
                    </div>
                </section>
            </template>

        </core-animated-pages>
    </template>

    <script>
        addEventListener('template-bound', function (e) {
            var scope = e.target;
            var items = [{
                name: "view 1",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 2",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 3",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 4",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 5",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 6",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 7",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }, {
                name: "view 8",
                icon: "/resources/images/test.svg",
                theme: "tomato",
                nameTheme: "#999999",
                textTheme: "white"
            }];


            scope.items = items;
            scope.whenDesktop = [
                [[], [], [], []],
                [[], [], [], []]
            ];
            scope.whenTablet = [
                [[], [], [], []],
                [[], [], [], []]
            ];
            scope.whenMobile = [
                [[], [], [], []],
                [[], [], [], []]
            ];
            
            scope.selectView = function(e) {
                var i = e.target.templateInstance.model.item;
                this.selected = i.name;
            };
            
            scope.back = function () {
                this.lastSelected = this.$.pages.selected;
                console.log(this.lastSelected);
                this.selected = 'menu';
            };

            scope.transitionend = function () {
                if (this.lastSelected) {
                    this.lastSelected = null;
                }
            };
        })
    </script>

</body>

</html>
