<link rel="import" href="/resources/polymer/polymer/polymer.html">

<!-- <link rel="import" href="/app/tg-reflector.html">
<link rel="import" href="/resources/serialisation/tg-serialiser.html"> -->
<link rel="import" href="/resources/polymer/paper-icon-button/paper-icon-button.html">
<!-- <link rel="import" href="/resources/polymer/paper-button/paper-button.html">
<link rel="import" href="/resources/components/postal-lib.html"> -->

<dom-module id="tg-page-action">
    <template>
        <paper-icon-button id="actionButton" icon="[[icon]]" on-tap="_run"></paper-icon-buton>
    </template>
</dom-module>

<script>
    Polymer({
    	is: 'tg-page-action',
    	
        properties: {
        	/////////////////////////////////////////////////////////////////////////////////////////////////////////
        	////////////////////////////////////////// EXTERNAL PROPERTIES //////////////////////////////////////////
        	/////////////////////////////////////////////////////////////////////////////////////////////////////////
        	// These mandatory properties must be specified in attributes, when constructing the element instance. //
        	// No default values are allowed in this case.														   //
        	/////////////////////////////////////////////////////////////////////////////////////////////////////////
        	/**
        	 * The action function (depends on context).
        	 */
        	action: {
        		type: Function
        	},
        	
        	/**
        	 * The context of this action.
        	 */
        	context: {
        		type: Object
        	},
        	
            /**
             * The icon specificator (string id).
             */
            icon: {
            	type: String
            },
            
            /**
             * Short description.
             */
            shortDesc: {
            	type: Function
            },
            
        	/////////////////////////////////////////////////////////////////////////////////////////////////////////
        	//////////////////////////////// INNER PROPERTIES, THAT GOVERN CHILDREN /////////////////////////////////
        	/////////////////////////////////////////////////////////////////////////////////////////////////////////
        	// These properties derive from other properties and are considered as 'private' -- need to have '_'   //
        	//   prefix. 																				           //
        	// Also, these properties are designed to be bound to children element properties -- it is necessary to//
        	//   populate their default values in ready callback (to have these values populated in children)!     //
        	/////////////////////////////////////////////////////////////////////////////////////////////////////////
            /**
             * Executes the action.
             *
             * Please override this method in descendands to implement specific execution logic.
             */
            _run: {
            	type: Function
            }
        },

        /**
         * Initialisation block.
         */
        ready: function () {
            var self = this;

            self._run = (function (e, detail, source) {
                // this.enabled = false;
                console.log(this.shortDesc + ": execute");

                // TODO var context = ...;
                // var ser = this.$.serialiser.serialise(context);
                // this.$.actionExecutor.body = JSON.stringify(ser);
                this.action(this.context);
            }).bind(self);
        }
    });
</script>