<link rel="import" href="/resources/polymer/polymer/polymer.html">
<link rel="import" href="/resources/polymer/core-toolbar/core-toolbar.html">
<link rel="import" href="/resources/polymer/core-icons/core-icons.html">
<link rel="import" href="/resources/polymer/paper-fab/paper-fab.html">
<link rel="import" href="/resources/components/postal-lib.html">
<link rel="import" href="/resources/element_loader/load-element.html">

<polymer-element name="tg-view" attributes="item" vertical layout>
    <template>
        <style>
            core-toolbar {
                height: 100px;
                background-color: #0288D1;
                color: white;
                font-size: 24px;
            }
            core-toolbar::shadow #topBar {
                height: 100px;
            }
            paper-fab {
                position: absolute;
                z-index: 1;
                bottom: -28px;
                right: 20px;
                background-color: #fcfcfc;
                color: #666464;
            }
            .view {
                background-color: white;
            }
        </style>


        <core-toolbar  slide-down>
            <div flex>{{item.title}}</div>
            <paper-fab icon="apps" on-tap="{{onShowMenuTap}}" scale-up></paper-fab>
        </core-toolbar>

        <div class="view" slide-up>
            {{item.title}}
        </div>

    </template>
    <script>
        (function () {
            Polymer({
                ready: function() {
                    postal.subscribe({
                        channel: this.item.title,
                        topic: "state.push",
                        callback: function(data, envelope) {
                            history.pushState(data.state);
                            postal.publish({
                                channel: "app",
                                topic: "state.pushed",
                                data: data
                            });
                        }
                    });
                    postal.subscribe({
                        channel: this.item.title,
                        topic: "state.pop",
                        callback: function(data, envelope) {
                            postal.publish({
                                channel: "app",
                                topic: "state.poped",
                                data: data
                            });
                        }
                    });
                },
                onShowMenuTap: function() {
                    this.fire("main-menu");
                }
            });
        })();
    </script>
</polymer-element>